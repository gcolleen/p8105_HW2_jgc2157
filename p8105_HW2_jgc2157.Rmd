---
title: "HW2"
author: "Gunnar"
date: "10/3/2021"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Loading libraries
```{r}
library(tidyverse)
library(janitor)
library(readxl)
```

_Problem 1_
Part 1. 
Loading Mr. Trash Wheel dataset
filtering out row totals
cleaning variable names and removing unnecssary variables
rounding sport balls to the nearest integer
```{r}
library(readxl)
df <- read_excel("working data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel")

df <- df %>%
  filter(!endsWith(Month, "Total")) %>%
  clean_names() %>%
  select(-x15, -x16, -x17) %>%
  mutate(sports_balls = round(sports_balls))

df %>%
  nrow()

df %>%
  pull(sports_balls) %>%
  head()


df %>%
  group_by(year) %>%
  summarize(mean(chip_bags))

```


Part 2. 
Importing 2018 and 2019 data sets
Remove first row of data
Add year variable to each data frame
Omit rows with missing precipitation data
Omit total row for each df
```{r}
df_p2019 <- read_excel("working data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2019 Precipitation", skip = 1)

df_p2019 <- df_p2019 %>%
  clean_names %>%
  mutate(year = 2019) %>%
  filter(!is.na(total)) %>%
  filter(!is.na(month))

df_p2018 <- read_excel("working data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "2018 Precipitation", skip = 1)  

df_p2018 <- df_p2018 %>%
  clean_names %>%
  mutate(year = 2018) %>%
  filter(!is.na(total)) %>%
  filter(!is.na(month))

df_p_combined <- bind_rows(df_p2018, df_p2019) %>%
  mutate(month = month.name[month])


df_p_combined %>%
  group_by(year) %>%
  summarise(mean(total))

nrow(df_p_combined)

```

Part 3. 

For the Mr. Trash Wheels data set, there were 344 observations spanning between 2014 and 2019. In 2015, there was a mean of 1849 chip bags found in a dumpster while in 2019 there was a mean of only 930. 

For the combined precipitation data set, there were 18 observations throughout 2018 and 2019. In 2018, the mean amount of precipitation was 5.86 inches while the mean amount of precipitation was 2.78 inches in 2019.


_Problem 2_
Loading pols-month.csv, unemployment.csv, and snp.csv
```{r}
pols_df <- read_csv("working data/fivethirtyeight_datasets/pols-month.csv")

unemploy_df <- read_csv("working data/fivethirtyeight_datasets/unemployment.csv")

snp_df <- read_csv("working data/fivethirtyeight_datasets/snp.csv")
```

Cleaning pols_month dataframe
```{r}
pols_df <- pols_df %>%
  separate(mon, into = c("year", "month", "day"), sep = "-") %>%
  mutate(month = as.numeric(month)) %>%
  mutate(month = month.name[month]) %>%
  mutate(prez = ifelse(prez_gop == 1, "gop", ifelse(prez_dem == 1, "dem", NA))) %>%
  select(year, month, -prez_gop, -prez_dem, -day)


names(pols_df)
head(pols_df$month)

```

Cleaning snp dataframe
```{r}
snp_df <- snp_df %>%
  separate(date, into = c("year", "month", "day"), sep = "/") %>%
  mutate(month = as.numeric(month)) %>% 
  mutate(year = as.numeric(year)) %>%
  mutate(month = month.name[month]) %>%
  mutate(year = year + 2000) %>%
  select(year, month, -day)

names(snp_df)
head(snp_df$year)
```

Cleaning unemployment dataframe
```{r}
unemploy_df <- unemploy_df %>%
  clean_names() %>%
  pivot_longer(cols = jan:dec, names_to = "month") %>%
  select(year, month)

names(unemploy_df)
```

Merging the data sets
```{r}
pols <- left_join(snp_df, pols_df)
pols
```

